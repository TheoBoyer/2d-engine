let cnv,e
const SPEED = 500
let jumping = false

window.onload = ()=>{
	cnv = document.getElementById('scene')

	e = new Engine(cnv)

	e.cameraTranslate(0,window.innerHeight/2)

	e.toggleLight()

	e.setLightPos({
		x: 300,
		y: 1000
	})

	e.noFPSLimit()

	e.setLightColor(255, 255, 255)

	e.setLightIntensity(1)

	e.setLightSize(15000)

	e.add(new Renderable(Renderable.ground()))

	let x = window.innerWidth

	for(let i=0; i<10; i++) {
		x+=Math.random()*50 + 20
		let w = 400 + Math.random()*100
		e.add(new Renderable(Renderable.ground({
			x: x,
			w: w
		})))
		x+=w
	}

	e.add(new Renderable({
		// Generated vertices
		v: [-0.30597014925373134,0.4827586206896552,-0.31343283582089554,0.4827586206896552,-0.3880597014925373,0.44482758620689655,-0.40298507462686567,0.39655172413793105,-0.3880597014925373,0.3517241379310345,-0.3283582089552239,0.3103448275862069,-0.22388059701492535,0.2689655172413793,-0.2164179104477612,0.22413793103448276,-0.3283582089552239,0.1896551724137931,-0.44029850746268656,0.17586206896551726,-0.4552238805970149,0.13448275862068965,-0.5,0.06551724137931036,-0.4925373134328358,-0.03103448275862064,-0.4925373134328358,-0.11379310344827587,-0.48507462686567165,-0.1724137931034483,-0.3731343283582089,-0.1724137931034483,-0.3731343283582089,-0.10689655172413792,-0.3731343283582089,-0.020689655172413834,-0.291044776119403,0.006896551724137945,-0.27611940298507465,-0.06896551724137934,-0.2462686567164179,-0.1448275862068965,-0.2462686567164179,-0.23448275862068968,-0.23880597014925375,-0.31034482758620685,-0.2164179104477612,-0.40689655172413797,-0.2164179104477612,-0.4862068965517241,-0.04477611940298509,-0.5,-0.03731343283582089,-0.39655172413793105,-0.03731343283582089,-0.3137931034482758,-0.022388059701492546,-0.24827586206896557,0,-0.19310344827586212,0.06716417910447758,-0.2310344827586207,0.10447761194029848,-0.29655172413793107,0.10447761194029848,-0.3551724137931035,0.12686567164179108,-0.41034482758620694,0.13432835820895528,-0.4517241379310345,0.16417910447761197,-0.4862068965517241,0.28358208955223885,-0.4896551724137931,0.35820895522388063,-0.45517241379310347,0.33582089552238803,-0.403448275862069,0.31343283582089554,-0.3310344827586207,0.31343283582089554,-0.26206896551724135,0.26865671641791045,-0.19999999999999996,0.24626865671641796,-0.14137931034482754,0.22388059701492535,-0.07241379310344831,0.22388059701492535,-0.017241379310344862,0.20895522388059706,0.03448275862068967,0.28358208955223885,0.006896551724137945,0.31343283582089554,-0.0482758620689655,0.35820895522388063,-0.08965517241379306,0.3955223880597015,-0.14137931034482754,0.5,-0.1344827586206897,0.4850746268656716,-0.08275862068965523,0.4552238805970149,-0.03448275862068961,0.417910447761194,0.017241379310344807,0.3805970149253731,0.07241379310344825,0.34328358208955223,0.13103448275862067,0.29850746268656714,0.16551724137931034,0.22388059701492535,0.19655172413793104,0.14179104477611937,0.2206896551724138,0.02238805970149249,0.2310344827586207,-0.04477611940298509,0.28620689655172415,-0.007462686567164201,0.3172413793103448,0.03731343283582089,0.3448275862068966,0.03731343283582089,0.3896551724137931,0.02985074626865669,0.43448275862068964,-0.02985074626865669,0.4724137931034483,-0.14179104477611942,0.496551724137931,-0.23134328358208955,0.5],
		p:{
			x: -250,
			y: 500,
			w: 50,
			h: 80
		},
		c: {
			name: 'Player'
		}
	}))

	e.setUserUpdate((e, dt)=>{
		if(e.keyboard.isPressed(37)){
			e.cameraTranslate(-SPEED*dt,0)
			e.objects('Player').translate(-SPEED*dt,0)
		}
		if(e.keyboard.isPressed(39)){
			e.cameraTranslate(SPEED*dt,0)
			e.objects('Player').translate(SPEED*dt,0)
		}
		if(e.keyboard.isPressed(32)&&e.objects('Player').isOnGround())
			e.objects('Player').addForce(400, 0, 1)
		
	})

	e.start()

	e.toggleFramerate()
}